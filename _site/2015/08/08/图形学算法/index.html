<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>图形学算法</title>
	<meta name="description" content="      判断点是否在矩形内      bool IsPointInRect(const Rect&amp; rc, const Point&amp; p)   	{   	    double xr = (p.x - rc.p1.x) * (p.x - rc.p2.x);   	    double yr =...">
	
	<link rel="canonical" href="/2015/08/08/%E5%9B%BE%E5%BD%A2%E5%AD%A6%E7%AE%97%E6%B3%95/">
	<link rel="alternate" type="application/rss+xml" title="48Game" href="/feed.xml" />
	
	<!-- <link rel="stylesheet" href="/css/main.css"> -->

	<link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css">
	<!-- <link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/fontawesome/4.2.0/css/font-awesome.min.css"> -->
	<!-- <link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css"> -->
	

	<link rel="stylesheet" type="text/css" href="/static/css/index.css">
	
	<!-- <script type="text/javascript" src="/static/js/jquery-1.11.1.min.js"></script>
	<script type="text/javascript" src="/static/js/bootstrap.min.js"></script> -->

	<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
	<script type="text/javascript" src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>

	<script type="text/javascript" src="/static/js/index.js"></script>
	
	<link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/highlight.js/8.4/styles/monokai_sublime.min.css">
	<!-- <link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/highlight.js/8.4/styles/railscasts.min.css"> -->
	<!-- <link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/highlight.js/8.4/styles/monokai.min.css"> -->
	<!-- <script type="text/javascript" src="http://apps.bdimg.com/libs/highlight.js/8.4/languages/dos.min.js"></script> -->
	<script type="text/javascript" src="http://apps.bdimg.com/libs/highlight.js/8.4/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

	<!--baidutongji-->
	<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?14501e724ea8e6d4153844422957c794";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	<!---->
</head>

 <!--  <body data-spy="scroll" data-target="#myAffix"> -->
  <body>

    <header>

<!-- navbar -->
  <nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">48Game</a>
      <p class="navbar-text">while(success!=try());</p>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">

        
          <li>
        
          <a href="/"><span class="glyphicon glyphicon-th-large"></span> Blog</a></li>

        
          
            
              <li>
            
            <a href="/play/"><span class="glyphicon glyphicon-play"></span> Play</a></li>
          
        
          
            
              <li>
            
            <a href="/about/"><span class="glyphicon glyphicon-heart"></span> About</a></li>
          
        
          
        
          
        
          
        
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

</header>


    <div id="main" class="container main">
      <div class="row">
  <div id="myArticle" class="col-sm-9">
    <div class="post-area post">
      <header>
        <h1>图形学算法</h1>
        <p>Aug 8, 2015</p>
      </header>
      <hr>
      <article>
        <ul>
  <li>
    <p>判断点是否在矩形内</p>

    <pre><code>  bool IsPointInRect(const Rect&amp; rc, const Point&amp; p)
   	{
   	    double xr = (p.x - rc.p1.x) * (p.x - rc.p2.x);
   	    double yr = (p.y - rc.p1.y) * (p.y - rc.p2.y);
   	    return ( (xr &lt;= 0.0) &amp;&amp; (yr &lt;= 0.0) );
   	}
</code></pre>
  </li>
  <li>
    <p>向量运算</p>

    <ul>
      <li>
        <p>叉乘</p>

        <p>P × Q = x1<em>y2 - x2</em>y1</p>
      </li>
      <li>
        <p>点乘</p>

        <p>P·Q = x1<em>x2 + y1</em>y2</p>
      </li>
    </ul>
  </li>
  <li>
    <p>快速排斥试验</p>

    <p>设以线段 P1P2 为对角线的矩形为R1， 设以线段 Q1Q2 为对角线的矩形为R2，如果R1和R2不相交，则两线段不会有交点；</p>
  </li>
  <li>
    <p>跨立试验</p>

    <p>如果两线段相交，则两线段必然相互跨立对方，所谓跨立，指的是一条线段的两端点分别位于另一线段所在直线的两边。判断是否跨立，还是要用到矢量叉积的几何意义。以图3为例，若P1P2跨立Q1Q2 ，则矢量</p>

    <p>( P1 - Q1 ) 和( P2 - Q1 )位于矢量( Q2 - Q1 )</p>

    <p>的两侧，即：</p>

    <p>( P1 - Q1 ) × ( Q2 - Q1 ) * ( P2 - Q1 ) × ( Q2 - Q1 ) &lt; 0</p>

    <p>上式可改写成：</p>

    <p>( P1 - Q1 ) × ( Q2 - Q1 ) * ( Q2 - Q1 ) × ( P2 - Q1 ) &gt; 0</p>

    <p>当</p>

    <p>( P1 - Q1 ) × ( Q2 - Q1 ) = 0</p>

    <p>时，说明线段P1P2和Q1Q2共线（但是不一定有交点）。同理判断Q1Q2跨立P1P2的依据是：</p>

    <p>( Q1 - P1 ) × ( P2 - P1 ) * ( Q2 - P1 ) × ( P2 - P1 ) &lt; 0</p>
  </li>
  <li>
    <p>判断点是否在多边形内</p>

    <pre><code>bool IsPointInPolygon(const Polygon&amp; py, const Point&amp; pt)
 {
     assert(py.IsValid()); /*只考虑正常的多边形，边数&gt;=3*/
	 
     int count = 0;
     LineSeg ll = LineSeg(pt, Point(-INFINITE, pt.y)); /*射线L*/
     for(int i = 0; i &lt; py.GetPolyCount(); i++)
     {
         /*当前点和下一个点组成线段P1P2*/
         LineSeg pp = LineSeg(py.pts[i], py.pts[(i + 1) % py.GetPolyCount()]);
         if(IsPointOnLineSegment(pp, pt))
         {
             return true;
         }
	 
         if(!pp.IsHorizontal())
         {
             if((IsSameFloatValue(pp.ps.y, pt.y)) &amp;&amp; (pp.ps.y &gt; pp.pe.y))
             {
                 count++;
             }
             else if((IsSameFloatValue(pp.pe.y, pt.y)) &amp;&amp; (pp.pe.y &gt; pp.ps.y))
             {
                 count++;
             }
             else
             {
                 if(IsLineSegmentIntersect(pp, ll))
                 {
                     count++;
                 }
             }
         }
     }
	 
     return ((count % 2) == 1);
 }
</code></pre>
  </li>
  <li>
    <p>求多边形外包矩形</p>

    <pre><code> void GetPolygonEnvelopRect(const Polygon&amp; py, Rect&amp; rc)
 {
     assert(py.IsValid()); /*只考虑正常的多边形，边数&gt;=3*/
	 
     double minx = py.pts[0].x;
     double maxx = py.pts[0].x;
     double miny = py.pts[0].y;
     double maxy = py.pts[0].y;
     for(int i = 1; i &lt; py.GetPolyCount(); i++)
     {
         if(py.pts[i].x &lt; minx)
             minx = py.pts[i].x;
         if(py.pts[i].x &gt; maxx)
             maxx = py.pts[i].x;
         if(py.pts[i].y &lt; miny)
             miny = py.pts[i].y;
         if(py.pts[i].y &gt; maxy)
             maxy = py.pts[i].y;
     }
	 
     rc = Rect(minx, miny, maxx, maxy);
 }
</code></pre>
  </li>
</ul>

      </article>
      <hr>

<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"></a><a href="#" class="bds_tsina" data-cmd="tsina"></a><a href="#" class="bds_tqq" data-cmd="tqq"></a><a href="#" class="bds_renren" data-cmd="renren"></a><a href="#" class="bds_weixin" data-cmd="weixin"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdPic":"","bdStyle":"0","bdSize":"16"},"share":{},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

    </div>
    <div class="post-area post comment">
      <!-- 多说评论框 start -->
      
      <div class="ds-thread" data-thread-key="/2015/08/08/图形学算法" data-title="图形学算法" data-url="/2015/08/08/%E5%9B%BE%E5%BD%A2%E5%AD%A6%E7%AE%97%E6%B3%95/"></div>
      
      <!-- 多说评论框 end -->
    </div>
  </div>

  <div id="content" class="col-sm-3">
    <!-- <div id="myAffix" class="shadow-bottom-center hidden-xs" data-spy="affix" data-offset-top="0" data-offset-bottom="-20"> -->
    <div id="myAffix" class="shadow-bottom-center hidden-xs" >
      <div class="categories-list-header">
        Content
      </div>
      <div class="content-text"></div>
    </div>
  </div>
</div>
    </div>

    
    <div id="top" data-toggle="tooltip" data-placement="left" title="回到顶部">
      <a href="javascript:;">
        <div class="arrow"></div>
        <div class="stick"></div>
      </a>
    </div>

    <footer class="">
  <div class="container">
    <div class="row">
      <div class="col-md-12">

          <span class="point"> · </span>
          <span>&copy; 2015 J</span>
          <span class="point"> · </span>

      </div>
    </div>
  </div>
</footer>


    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
  <script type="text/javascript">
    var duoshuoQuery = {short_name:"48game"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
<!-- 多说公共JS代码 end -->

<!-- 在新窗口中打开 -->
  <script type="text/javascript">
    function addBlankTargetForLinks () {
      $('a[href^="http"]').each(function(){
          $(this).attr('target', '_blank');
      });
    }
    //每次在有DOM插入时触发
    $(document).bind('DOMNodeInserted', function(event) {
      addBlankTargetForLinks();
    });
  </script>
  </body>
</html>
